<!--
  ~ Copyright (c) 2026 Luis Paolo Pepe Barra (@LuisPPB16).
  ~ All rights reserved.
  -->

<idea-plugin>
    <id>com.luisppb16.dbseed</id>
    <name>DBSeed4SQL</name>
    <vendor email="ironkrozz@gmail.com">Luis Pepe</vendor>
    <description>
        <![CDATA[
            A smart SQL seed generator that respects your schema's integrity.

            This plugin generates synthetic data by introspects your database's `DatabaseMetaData`.
            It automatically analyzes table dependencies, manages foreign keys, and resolves complex cycles using Tarjan's algorithm.
            Stop writing manual insert scripts for your test environments.
            <h2>Main Features</h2>
              <li>Schema introspection via DatabaseMetaData.</li>
              <li>Table sorting using Tarjan's algorithm to detect cycles.</li>
              <li>Synthetic data generation with DataFaker.</li>
              <li>Cycle handling with deferred constraints.</li>
              <li>Support for multiple databases with dynamic driver downloads.</li>
        ]]>
    </description>

    <change-notes>
        <![CDATA[
            <h3>Version 1.3.0</h3>
            <ul>
                <li><b>AI-Powered Data Generation (Ollama):</b> Generate context-aware, realistic data using an external Ollama LLM server.
                    <ul>
                        <li>New "AI Columns" tab in the configuration dialog lets you choose which string columns get AI-generated content.</li>
                        <li>Configurable word count per AI value (one word up to full paragraphs).</li>
                        <li><b>Note:<b> only the column name along with the context previously provided by the user is sent to the AI.</li>
                    </ul>
                </li>
                <li><b>AI Settings in Global Configuration:</b>
                    <ul>
                        <li>Enable/disable AI generation, set Ollama URL and model. You can use whether local or cloud-based models.</li>
                        <li>"Get models" button with a live server connectivity check.</li>
                        <li>Application context text area to guide the AI towards your domain.</li>
                        <li>Words per AI value spinner to control output length.</li>
                    </ul>
                </li>
                <li><b>Auto-Detect SQL Dialect:</b> <code>DialectFactory</code> now auto-detects the correct dialect from the driver class name or JDBC URL when no explicit dialect is configured.</li>
                <li><b>Dialect System Cleanup:</b> Removed property-driven check constraint configuration from dialect files. Dialects are now simpler and more maintainable.</li>
                <li><b>Improved Error Handling:</b> Seed actions now show modal error dialogs instead of balloon notifications, with proper thread-safe modality state.</li>
                <li><b>Repetition Rule Fix:</b> String values in repetition rule fixed columns are now properly parsed into their typed representation before use.</li>
            </ul>

            <h3>Version 1.2.5</h3>
            <ul>
                <li><b>Multi-Dialect Support:</b> Added support for SQLite and improved driver configuration for various SQL dialects.</li>
                <li><b>Performance Optimizations:</b>
                    <ul>
                        <li>Optimized SQL generation and string concatenation.</li>
                        <li>Improved Schema Introspection to avoid N+1 queries.</li>
                        <li>Implemented caching for dictionary words and identifier quoting.</li>
                        <li>Optimized UUID generation.</li>
                    </ul>
                </li>
                <li><b>New Features & Configuration:</b>
                    <ul>
                        <li>Added user-configurable numeric scale for data generation.</li>
                        <li>Implemented Soft Delete configuration.</li>
                        <li>Improved decimal handling and repetition rules.</li>
                        <li>Refactored Settings UI for better usability.</li>
                    </ul>
                </li>
                <li><b>Stability:</b> Comprehensive test suite implementation and bug fixes.</li>
            </ul>

            <h3>Previous Versions</h3>
            <ul>
              <li><b>Plugin Renamed:</b> The plugin has been renamed from "Database Seed Generator" to "DBSeed4SQL" to better reflect its functionality and branding.</li>
              <li><b>Configurable Dictionaries for Data Generation:</b> Introduced flexible dictionary usage with checkboxes for Latin (Faker default), English, and Spanish. Users can now combine these dictionaries to generate more realistic and contextually relevant string data.</li>
              <li><b>Batch Query Execution:</b> Optimized SQL script generation to execute queries in batches, significantly improving performance for large datasets.</li>
              <li><b>Configuration Window:</b> Introduced a dedicated configuration window within the IDE, allowing users to easily customize default settings and generation parameters.</li>
              <li><b>Warning Pop-up for Large Row Generation:</b> Added a warning pop-up to alert users when generating a large number of rows, preventing accidental overload.</li>
              <li><b>Show Password Toggle in Input Field:</b> Implemented a "show password" toggle (eye icon) in password input field for improved usability.</li>
              <li><b>Overall Performance Improvements:</b> Significant enhancements across the plugin for a smoother and faster user experience.</li>
              <li><b>Migrate to Java 21:</b> The plugin has been fully migrated to Java 21, ensuring compatibility with the latest Java features and better performance.</li>
              <li><b>Select All Primary Keys Feature:</b> The PK selection dialog now allows selecting all primary keys at once, streamlining workflows when working with complex schemas.</li>
              <li><b>Exclude Columns Tab:</b> Added a user interface tab that lets users exclude specific columns from synthetic data generation, offering increased flexibility and customization for testing scenarios.</li>
              <li><b>UI Fixes and Improvements:</b> The cancel button in dialogs now works reliably. Minor interface enhancements and wording improvements were also made for better usability.</li>
              <li><b>Copyright and Minor Enhancements:</b> Copyright statements have been updated and minor bugs have been fixed for a smoother experience.</li>
              <li><b>Primary Key Selection Bug Fixes:</b> Several fixes were applied to the <code>PK Selection Dialog</code>, addressing stability and functional issues.</li>
            </ul>
        ]]>
    </change-notes>

    <depends>com.intellij.modules.platform</depends>

    <actions>
        <action id="SeedDatabaseAction"
                class="com.luisppb16.dbseed.action.SeedDatabaseAction"
                text="DBSeed4SQL"
                description="Generates seed SQL script.">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>
        <action id="SchemaDesignerAction"
                class="com.luisppb16.dbseed.ui.SchemaDesigner"
                text="Schema Designer"
                description="Opens the Schema Designer tool.">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>
    </actions>
    <extensions defaultExtensionNs="com.intellij">
        <notificationGroup id="DBSeed4SQL"
                           displayType="BALLOON"
                           isLogByDefault="true"/>
        <applicationService serviceImplementation="com.luisppb16.dbseed.config.DbSeedSettingsState"/>
        <applicationConfigurable instance="com.luisppb16.dbseed.config.DbSeedSettingsConfigurable"
                                 id="com.luisppb16.dbseed.config.DbSeedSettingsConfigurable"
                                 displayName="DBSeed4SQL"/>
    </extensions>
</idea-plugin>
